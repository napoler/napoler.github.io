---
layout: post
title: 'Flag 模块完全使用指南Drupal专注于收藏的模块-Drupal每日推荐一模块'
permalink: '/2014/04/flag-drupal-drupal_19.html'
comments: 1
categories: Default
tags: Flag 模块 Drupal每日推荐一模块 收藏
comments: 1
---
<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><span style="color: #0000ee;"><strong>flag模块</strong>是一个灵活的标记制度，是完全可通过管理员进行定制。使用此模块，网站管理员可以对任意数量的节点、评论、用户进行标记。这些标记包括书签、标记重要、朋友或检举。您可以创建自定义清单流行内容或监视重要内容。</span><span style="color: #0000ee;"><strong>flag</strong>标记可以是全局的，也可以是个人的。全局的标记意味着你可以标记如精华评论、重点内容等，而个人标记则可能是我的收藏、推荐等，与每个用户相关。</span><span style="color: #0000ee;"><strong>flag模块</strong>是一个灵活的标记模块,使用这个模块可以标记任意的节点、评论、用户等内容,可以通过这个模块将节点标记为精华、垃圾或者你想做的任何标记.<strong>flag模块</strong>还可以和<strong>views2</strong>进行整合进行操作,同时flag还支持<strong>action</strong>.在官方网站上有非常详细的文档.</span></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><span style="color: #0000ee;"><strong>在</strong><strong>flag模块</strong><strong>中用图片替代链接的处理</strong></span></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><span style="color: #0000ee;"><strong>flag模块</strong>默认为使用的是文本链接，如何使用图片来替代文本链接，这里给出了一个解决方法在模板的中加入预处理函数，就是在模板文件的<strong>template.php</strong>文件中，加入下列代码</span></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">function phptemplate_preprocess_flag(&amp;$vars) {</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">$image_file = path_to_theme() . ‘/flag-’ . $vars[‘flag_name_css’] . ‘-’ . ($vars[‘action’] == ‘flag’ ? ‘off’ : ‘on’) . ‘.png’;</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">// Uncomment the following line when debugging.</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">//drupal_set_message(“Flag is looking for ‘$image_file’…”);</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">if (file_exists($image_file)) {</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">$vars[‘link_text’] = ‘&lt;img src=”‘ . base_path() . $image_file . ‘” /&gt;’;</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">}</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">}</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">注意事项</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">将<strong>flag组件</strong>下的theme目录中的flag.tpl.php要复制到模板目录中</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">要加入图片文件（flag-flagname-on.png,flag-flagname-off.png,）</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">清空缓存之后，再看效果</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><strong>使用Flag来标记精华评论</strong></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; text-align: justify;"><div style="line-height: 17px;"><a href="http://drupal.org/project/flag" style="color: black; font-weight: bold;" title="flag 模块">flag</a>模块是一个灵活的标记模块,使用这个模块可以标记任意的节点、评论、用户等内容,可以通过这个模块将节点标记为精华、垃圾或者你想做的任何标记.flag模块还可以和views2进行整合进行操作,同时flag还支持action.在官方网站上有非常详细的<a href="http://drupal.org/handbook/modules/flag" style="color: black; font-weight: bold;" title="官方文档">文档</a>.</div><div style="line-height: 17px;">下面我就讲讲利用<strong>Flag模块</strong>，给评论加个精华。</div><div style="line-height: 17px;">安装<strong>Flag模块</strong></div><div style="line-height: 17px;">和所有模块一样,下载,在模块设置中进行安装.</div><div style="line-height: 17px;">配置<strong>Flag模块</strong></div><div style="line-height: 17px;">全局的flag和私人的flag,在<strong>flag模块</strong>中,标记分为全局和私人的2类,如果是私人flag,那么每个有仅进行标记的人都可以去更改它,而不会影响他人,如对文章进行收藏,全局的flag改变之后对所有用户都会影响,如管理员对评论进行加精,那么所有人都会看到这个精华标志.</div><div style="line-height: 17px;">用admin/build/flags进行对<strong>flag进行设置</strong>:</div><div style="line-height: 17px;"><img alt="flag 模块配置简解" border="0" height="380" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag1.jpg" width="592"/></div><div style="line-height: 17px;"><img alt="flag 模块增加flag" border="0" height="413" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag2.jpg" width="440"/></div><div style="line-height: 17px;"><img alt="flag 模块配置" border="0" height="1200" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag3.jpg" width="405"/></div><div style="line-height: 17px;">增加好之后，在前台就可以对评论节点进行精华标志。</div><div style="line-height: 17px;"><img alt="flag views配置" border="0" height="466" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag4.jpg" width="710"/></div><div style="line-height: 17px;">把区块放到模板的指定位置，就可以看到精华评论。</div><div style="line-height: 17px;">Flag模块在模板中运用。</div><div style="line-height: 17px;">前面这些工作完成之后，当然还没完，怎么加入精华的评论与一般评论没有区别，那还要针对模板进行一些设置。参考<a href="http://drupal.org/node/295346" style="color: black; font-weight: bold;" title="flag 模块在模板中的应用">这里</a>的内容</div><div style="line-height: 17px;">打开模板文件中的template.php文件，加入phptemplate_preprocess_comment函数</div><div style="line-height: 17px;">static $flags;<br/>if (!module_exists(‘flag’)) {<br/>return;<br/>}<br/>if (!isset($flags)) {<br/>$flags = flag_get_flags(‘comment’);<br/>}<br/>// Note: is_flagged() and get_count() use internal cache,<br/>// so using them won’t result in issuing excessive SQL queries.<br/>$classes = array();<br/>$cid = $vars[‘comment’]-&gt;cid;<br/>foreach ($flags as $flag) {<br/>$css_name = str_replace(‘_’, ‘-’, $flag-&gt;name);<br/>if ( $flag-&gt;is_flagged($cid)) {<br/>$classes[] = ‘comment-flagged-’ . $css_name;<br/>}<br/>}<br/>$vars[‘flag_classes’] = implode(‘ ‘, $classes);</div><div style="line-height: 17px;">这段是取得是否标志精华，如果是的话，加了一个$vars[‘flag_classes’]的类。这个东东就可以在comment.tpl.php文件中使用。</div><div style="line-height: 17px;">&lt;!– start comment.tpl.php –&gt;<br/>&lt;div class=”comment &lt;?php print $comment_classes;?&gt;&nbsp; clear-block”&gt;<br/>&lt;?php print $picture ?&gt;<br/>&lt;?php if ($comment-&gt;new): ?&gt;<br/>&lt;a id=”new”&gt;&lt;/a&gt;<br/>&lt;span class=”new”&gt;&lt;?php print $new ?&gt;&lt;/span&gt;<br/>&lt;?php endif; ?&gt;<br/>&lt;h3 class=”title&nbsp;<span style="color: red;">&lt;?php echo $flag_classes; ?&gt;</span>“&gt;&lt;?php print $title ?&gt;&lt;/h3&gt;<br/>&lt;div class=”submitted”&gt;<br/>&lt;?php print $submitted ?&gt;<br/>&lt;/div&gt;<br/>&lt;div class=”content”&gt;<br/>&lt;?php print $content ?&gt;<br/>&lt;?php if ($signature): ?&gt;<br/>&lt;div class=”signature”&gt;<br/>&lt;?php print $signature ?&gt;<br/>&lt;/div&gt;<br/>&lt;?php endif; ?&gt;<br/>&lt;/div&gt;<br/>&lt;?php if ($links): ?&gt;<br/>&lt;div class=”links”&gt;<br/>&lt;?php print $links ?&gt;<br/>&lt;/div&gt;<br/>&lt;?php endif; ?&gt;<br/>&lt;/div&gt;<br/>&lt;!– /end comment.tpl.php –&gt;</div><div style="line-height: 17px;">红色部份是我加入的代码，如果是精华的话，那么会在标题中有一个CSS类叫comment-flagged-picks，其中picks是我flag　name.</div><div style="line-height: 17px;">然后在你的模板CSS文件中加入</div><div style="line-height: 17px;">.comment-flagged-picks{<br/>background: url(‘images/raquo.png’) no-repeat left 0.833em; //图片当然自己去找<br/>padding-left: 13px;<br/>}</div><div><h3 style="margin: 0px 0px 5px;">特别注意</h3><div style="line-height: 17px;">Flag模块也是支持模板的，但其中的模板文件是用flag<span style="color: red;">–</span>flagname.tpl.php,是2个-,一个不留神，搞了好长。</div><div style="line-height: 17px;"><strong>flag 模块在模板中ajax的显示</strong></div><div style="line-height: 17px;">在模板中应用flag变量之后，已经可以标示出精华评论了，美中不足的是尽管加入是有ajax效果，但不能直接在标题中显示出来，如何在标题中也同步显示出来呢？复制flag模块的theme目录到你的模板目录中去</div><div style="line-height: 17px;">修改flag.tpl.php为flag–flagname.tpl.php（只针对特定的flag标记应用模板）</div><div style="line-height: 17px;">打开这个文件之后，把原来加入的CSS和JS文件去了，加入自己的，用下列代码修改</div><div style="line-height: 17px;">$current_theme = variable_get(‘theme_default’,’none’);</div><div style="line-height: 17px;">drupal_add_css(drupal_get_path(‘theme’, $current_theme) .’/flag.css’);</div><div style="line-height: 17px;">drupal_add_js(drupal_get_path(‘theme’, $current_theme) .’/flag.js’);</div><div style="line-height: 17px;">打开flag.js，80行左右</div><div style="line-height: 17px;">if (data.status) {</div><div style="line-height: 17px;">// Success.</div><div style="line-height: 17px;">$(‘#c’+data[‘contentId’]).toggleClass(‘comment-flagged-picks’ );//这个是我加入的，为了在成功之后，在当前的评论增加/移除类comment-flagged-picks</div><div style="line-height: 17px;">data.link = $wrapper.get(0);</div><div style="line-height: 17px;">当然还要修改comment.tpl.php</div><div style="line-height: 17px;">&lt;h3 class=”title &lt;?php echo $flag_classes; ?&gt;” id=”&lt;?php echo ‘c’.$comment-&gt;cid; ?&gt;”&gt;&lt;?php print $title ?&gt;&lt;/h3&gt;//红色部分加入是要让js找到要标示的元素，我是用C+评论ID来识别的。</div><div style="line-height: 17px;">OK，经过这样之后，点击加入精华的链接，能同时给评论标题增加/移除类，达到同步的效果。</div><div style="line-height: 17px;">以上内容整理自http://joom.net.ru</div></div></div>---
layout: post
title: 'Flag 模块完全使用指南Drupal专注于收藏的模块-Drupal每日推荐一模块'
permalink: '/2014/04/flag-drupal-drupal.html'
comments: 1
categories: Default
tags: Flag 模块 Drupal每日推荐一模块 收藏
comments: 1
---
<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><span style="color: #0000ee;"><strong>flag模块</strong>是一个灵活的标记制度，是完全可通过管理员进行定制。使用此模块，网站管理员可以对任意数量的节点、评论、用户进行标记。这些标记包括书签、标记重要、朋友或检举。您可以创建自定义清单流行内容或监视重要内容。</span><span style="color: #0000ee;"><strong>flag</strong>标记可以是全局的，也可以是个人的。全局的标记意味着你可以标记如精华评论、重点内容等，而个人标记则可能是我的收藏、推荐等，与每个用户相关。</span><span style="color: #0000ee;"><strong>flag模块</strong>是一个灵活的标记模块,使用这个模块可以标记任意的节点、评论、用户等内容,可以通过这个模块将节点标记为精华、垃圾或者你想做的任何标记.<strong>flag模块</strong>还可以和<strong>views2</strong>进行整合进行操作,同时flag还支持<strong>action</strong>.在官方网站上有非常详细的文档.</span></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><span style="color: #0000ee;"><strong>在</strong><strong>flag模块</strong><strong>中用图片替代链接的处理</strong></span></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><span style="color: #0000ee;"><strong>flag模块</strong>默认为使用的是文本链接，如何使用图片来替代文本链接，这里给出了一个解决方法在模板的中加入预处理函数，就是在模板文件的<strong>template.php</strong>文件中，加入下列代码</span></div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">function phptemplate_preprocess_flag(&amp;$vars) {</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">$image_file = path_to_theme() . ‘/flag-’ . $vars['flag_name_css'] . ‘-’ . ($vars['action'] == ‘flag’ ? ‘off’ : ‘on’) . ‘.png’;</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">// Uncomment the following line when debugging.</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">//drupal_set_message(“Flag is looking for ‘$image_file’…”);</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">if (file_exists($image_file)) {</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">$vars['link_text'] = ‘&lt;img src=”‘ . base_path() . $image_file . ‘” /&gt;’;</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">}</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">}</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">注意事项</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">将<strong>flag组件</strong>下的theme目录中的flag.tpl.php要复制到模板目录中</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">要加入图片文件（flag-flagname-on.png,flag-flagname-off.png,）</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;">清空缓存之后，再看效果</div>

<div style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; line-height: 17px; text-align: justify;"><strong>使用Flag来标记精华评论</strong></div>

<div class="content" style="background-color: white; font-family: Arial, Verdana, sans-serif; font-size: 14px; text-align: justify;"><div style="line-height: 17px;"><a href="http://drupal.org/project/flag" style="color: black; font-weight: bold;" title="flag 模块">flag</a>模块是一个灵活的标记模块,使用这个模块可以标记任意的节点、评论、用户等内容,可以通过这个模块将节点标记为精华、垃圾或者你想做的任何标记.flag模块还可以和views2进行整合进行操作,同时flag还支持action.在官方网站上有非常详细的<a href="http://drupal.org/handbook/modules/flag" style="color: black; font-weight: bold;" title="官方文档">文档</a>.</div><div style="line-height: 17px;">下面我就讲讲利用<strong>Flag模块</strong>，给评论加个精华。</div><div class="stickynote" style="line-height: 17px;">安装<strong>Flag模块</strong></div><div style="line-height: 17px;">和所有模块一样,下载,在模块设置中进行安装.</div><div class="stickynote" style="line-height: 17px;">配置<strong>Flag模块</strong></div><div style="line-height: 17px;">全局的flag和私人的flag,在<strong>flag模块</strong>中,标记分为全局和私人的2类,如果是私人flag,那么每个有仅进行标记的人都可以去更改它,而不会影响他人,如对文章进行收藏,全局的flag改变之后对所有用户都会影响,如管理员对评论进行加精,那么所有人都会看到这个精华标志.</div><div style="line-height: 17px;">用admin/build/flags进行对<strong>flag进行设置</strong>:</div><div style="line-height: 17px;"><img alt="flag 模块配置简解" border="0" height="380" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag1.jpg" width="592"/></div><div style="line-height: 17px;"><img alt="flag 模块增加flag" border="0" height="413" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag2.jpg" width="440"/></div><div style="line-height: 17px;"><img alt="flag 模块配置" border="0" height="1200" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag3.jpg" width="405"/></div><div style="line-height: 17px;">增加好之后，在前台就可以对评论节点进行精华标志。</div><div style="line-height: 17px;"><img alt="flag views配置" border="0" height="466" src="http://napoler.ixiezi.com/sites/joom.net.ru/files/u3/flag4.jpg" width="710"/></div><div style="line-height: 17px;">把区块放到模板的指定位置，就可以看到精华评论。</div><div class="stickynote" style="line-height: 17px;">Flag模块在模板中运用。</div><div style="line-height: 17px;">前面这些工作完成之后，当然还没完，怎么加入精华的评论与一般评论没有区别，那还要针对模板进行一些设置。参考<a href="http://drupal.org/node/295346" style="color: black; font-weight: bold;" title="flag 模块在模板中的应用">这里</a>的内容</div><div style="line-height: 17px;">打开模板文件中的template.php文件，加入phptemplate_preprocess_comment函数</div><div class="code" style="line-height: 17px;">static $flags;<br/>if (!module_exists(‘flag’)) {<br/>return;<br/>}<br/>if (!isset($flags)) {<br/>$flags = flag_get_flags(‘comment’);<br/>}<br/>// Note: is_flagged() and get_count() use internal cache,<br/>// so using them won’t result in issuing excessive SQL queries.<br/>$classes = array();<br/>$cid = $vars['comment']-&gt;cid;<br/>foreach ($flags as $flag) {<br/>$css_name = str_replace(‘_’, ‘-’, $flag-&gt;name);<br/>if ( $flag-&gt;is_flagged($cid)) {<br/>$classes[] = ‘comment-flagged-’ . $css_name;<br/>}<br/>}<br/>$vars['flag_classes'] = implode(‘ ‘, $classes);</div><div style="line-height: 17px;">这段是取得是否标志精华，如果是的话，加了一个$vars['flag_classes']的类。这个东东就可以在comment.tpl.php文件中使用。</div><div class="code" style="line-height: 17px;">&lt;!– start comment.tpl.php –&gt;<br/>&lt;div class=”comment &lt;?php print $comment_classes;?&gt;&nbsp; clear-block”&gt;<br/>&lt;?php print $picture ?&gt;<br/>&lt;?php if ($comment-&gt;new): ?&gt;<br/>&lt;a id=”new”&gt;&lt;/a&gt;<br/>&lt;span class=”new”&gt;&lt;?php print $new ?&gt;&lt;/span&gt;<br/>&lt;?php endif; ?&gt;<br/>&lt;h3 class=”title&nbsp;<span style="color: red;">&lt;?php echo $flag_classes; ?&gt;</span>“&gt;&lt;?php print $title ?&gt;&lt;/h3&gt;<br/>&lt;div class=”submitted”&gt;<br/>&lt;?php print $submitted ?&gt;<br/>&lt;/div&gt;<br/>&lt;div class=”content”&gt;<br/>&lt;?php print $content ?&gt;<br/>&lt;?php if ($signature): ?&gt;<br/>&lt;div class=”signature”&gt;<br/>&lt;?php print $signature ?&gt;<br/>&lt;/div&gt;<br/>&lt;?php endif; ?&gt;<br/>&lt;/div&gt;<br/>&lt;?php if ($links): ?&gt;<br/>&lt;div class=”links”&gt;<br/>&lt;?php print $links ?&gt;<br/>&lt;/div&gt;<br/>&lt;?php endif; ?&gt;<br/>&lt;/div&gt;<br/>&lt;!– /end comment.tpl.php –&gt;</div><div style="line-height: 17px;">红色部份是我加入的代码，如果是精华的话，那么会在标题中有一个CSS类叫comment-flagged-picks，其中picks是我flag　name.</div><div style="line-height: 17px;">然后在你的模板CSS文件中加入</div><div class="code" style="line-height: 17px;">.comment-flagged-picks{<br/>background: url(‘images/raquo.png’) no-repeat left 0.833em; //图片当然自己去找<br/>padding-left: 13px;<br/>}</div><div class="legend"><h3 class="legend-title" style="margin: 0px 0px 5px;">特别注意</h3><div style="line-height: 17px;">Flag模块也是支持模板的，但其中的模板文件是用flag<span style="color: red;">–</span>flagname.tpl.php,是2个-,一个不留神，搞了好长。</div><div style="line-height: 17px;"><strong>flag 模块在模板中ajax的显示</strong></div><div style="line-height: 17px;">在模板中应用flag变量之后，已经可以标示出精华评论了，美中不足的是尽管加入是有ajax效果，但不能直接在标题中显示出来，如何在标题中也同步显示出来呢？复制flag模块的theme目录到你的模板目录中去</div><div style="line-height: 17px;">修改flag.tpl.php为flag–flagname.tpl.php（只针对特定的flag标记应用模板）</div><div style="line-height: 17px;">打开这个文件之后，把原来加入的CSS和JS文件去了，加入自己的，用下列代码修改</div><div style="line-height: 17px;">$current_theme = variable_get(‘theme_default’,'none’);</div><div style="line-height: 17px;">drupal_add_css(drupal_get_path(‘theme’, $current_theme) .’/flag.css’);</div><div style="line-height: 17px;">drupal_add_js(drupal_get_path(‘theme’, $current_theme) .’/flag.js’);</div><div style="line-height: 17px;">打开flag.js，80行左右</div><div style="line-height: 17px;">if (data.status) {</div><div style="line-height: 17px;">// Success.</div><div style="line-height: 17px;">$(‘#c’+data['contentId']).toggleClass(‘comment-flagged-picks’ );//这个是我加入的，为了在成功之后，在当前的评论增加/移除类comment-flagged-picks</div><div style="line-height: 17px;">data.link = $wrapper.get(0);</div><div style="line-height: 17px;">当然还要修改comment.tpl.php</div><div style="line-height: 17px;">&lt;h3 class=”title &lt;?php echo $flag_classes; ?&gt;” id=”&lt;?php echo ‘c’.$comment-&gt;cid; ?&gt;”&gt;&lt;?php print $title ?&gt;&lt;/h3&gt;//红色部分加入是要让js找到要标示的元素，我是用C+评论ID来识别的。</div><div style="line-height: 17px;">OK，经过这样之后，点击加入精华的链接，能同时给评论标题增加/移除类，达到同步的效果。</div><div style="line-height: 17px;">以上内容整理自http://joom.net.ru</div></div></div>